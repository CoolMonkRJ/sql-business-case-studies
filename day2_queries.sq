üü¢ SALES & REVENUE
1Ô∏è‚É£ Total revenue by product category:
SELECT 
    c.CategoryName,
    SUM(od.UnitPrice * od.Quantity) AS total_revenue
FROM order_details od
JOIN products p ON od.ProductID = p.ProductID
JOIN categories c ON p.CategoryID = c.CategoryID
GROUP BY c.CategoryName
ORDER BY total_revenue DESC;

2Ô∏è‚É£ Total revenue by country (region) :
SELECT 
    cust.Country,
    SUM(od.UnitPrice * od.Quantity) AS total_revenue
FROM customers cust
JOIN orders o ON cust.CustomerID = o.CustomerID
JOIN order_details od ON o.OrderID = od.OrderID
GROUP BY cust.Country
ORDER BY total_revenue DESC;

3Ô∏è‚É£ Monthly revenue trend :
SELECT 
    DATE_FORMAT(o.OrderDate, '%Y-%m') AS month,
    SUM(od.UnitPrice * od.Quantity) AS monthly_revenue
FROM orders o
JOIN order_details od ON o.OrderID = od.OrderID
GROUP BY month
ORDER BY month;

4Ô∏è‚É£ Average order value by country :
SELECT 
    cust.Country,
    AVG(order_totals.order_value) AS avg_order_value
FROM (
    SELECT 
        o.OrderID,
        o.CustomerID,
        SUM(od.UnitPrice * od.Quantity) AS order_value
    FROM orders o
    JOIN order_details od ON o.OrderID = od.OrderID
    GROUP BY o.OrderID, o.CustomerID
) order_totals
JOIN customers cust ON order_totals.CustomerID = cust.CustomerID
GROUP BY cust.Country;

5Ô∏è‚É£ Revenue by product :
SELECT 
    p.ProductName,
    SUM(od.UnitPrice * od.Quantity) AS revenue
FROM products p
JOIN order_details od ON p.ProductID = od.ProductID
GROUP BY p.ProductName
ORDER BY revenue DESC;

üü° CUSTOMER ANALYTICS

6Ô∏è‚É£ Top 10 customers by lifetime value :
SELECT 
    cust.CompanyName,
    SUM(od.UnitPrice * od.Quantity) AS lifetime_value
FROM customers cust
JOIN orders o ON cust.CustomerID = o.CustomerID
JOIN order_details od ON o.OrderID = od.OrderID
GROUP BY cust.CompanyName
ORDER BY lifetime_value DESC
LIMIT 10;

7Ô∏è‚É£ Average revenue per customer
SELECT 
    AVG(customer_revenue) AS avg_revenue_per_customer
FROM (
    SELECT 
        cust.CustomerID,
        SUM(od.UnitPrice * od.Quantity) AS customer_revenue
    FROM customers cust
    JOIN orders o ON cust.CustomerID = o.CustomerID
    JOIN order_details od ON o.OrderID = od.OrderID
    GROUP BY cust.CustomerID
) t;

8Ô∏è‚É£ Number of orders per customer :
SELECT 
    cust.CompanyName,
    COUNT(o.OrderID) AS total_orders
FROM customers cust
LEFT JOIN orders o ON cust.CustomerID = o.CustomerID
GROUP BY cust.CompanyName
ORDER BY total_orders DESC;

9Ô∏è‚É£ Customers with only one order :
SELECT 
    cust.CompanyName,
    COUNT(o.OrderID) AS order_count
FROM customers cust
JOIN orders o ON cust.CustomerID = o.CustomerID
GROUP BY cust.CompanyName
HAVING order_count = 1;

üîü Customer distribution by country :
SELECT 
    Country,
    COUNT(*) AS customer_count
FROM customers
GROUP BY Country
ORDER BY customer_count DESC;


üîµ PRODUCT & INVENTORY INSIGHTS

1Ô∏è‚É£1Ô∏è‚É£ Number of products per category :
SELECT 
    c.CategoryName,
    COUNT(p.ProductID) AS product_count
FROM categories c
JOIN products p ON c.CategoryID = p.CategoryID
GROUP BY c.CategoryName;

1Ô∏è‚É£2Ô∏è‚É£ Average product price by category :
SELECT 
    c.CategoryName,
    AVG(p.UnitPrice) AS avg_price
FROM categories c
JOIN products p ON c.CategoryID = p.CategoryID
GROUP BY c.CategoryName;

1Ô∏è‚É£3Ô∏è‚É£ Top 5 most sold products (by quantity)
SELECT 
    p.ProductName,
    SUM(od.Quantity) AS total_quantity_sold
FROM products p
JOIN order_details od ON p.ProductID = od.ProductID
GROUP BY p.ProductName
ORDER BY total_quantity_sold DESC
LIMIT 5;

1Ô∏è‚É£4Ô∏è‚É£ Products never ordered
SELECT 
    p.ProductName
FROM products p
LEFT JOIN order_details od ON p.ProductID = od.ProductID
WHERE od.ProductID IS NULL;


üü£ ORDER BEHAVIOR

1Ô∏è‚É£5Ô∏è‚É£ Orders per year :
SELECT 
    YEAR(OrderDate) AS order_year,
    COUNT(*) AS total_orders
FROM orders
GROUP BY order_year
ORDER BY order_year;

1Ô∏è‚É£6Ô∏è‚É£ Average number of items per order :
SELECT 
    AVG(item_count) AS avg_items_per_order
FROM (
    SELECT 
        OrderID,
        SUM(Quantity) AS item_count
    FROM order_details
    GROUP BY OrderID
) t;

1Ô∏è‚É£7Ô∏è‚É£ Orders by employee :
SELECT 
    e.FirstName,
    e.LastName,
    COUNT(o.OrderID) AS total_orders
FROM employees e
JOIN orders o ON e.EmployeeID = o.EmployeeID
GROUP BY e.EmployeeID
ORDER BY total_orders DESC;


üî¥ ADVANCED BUSINESS THINKING

1Ô∏è‚É£8Ô∏è‚É£ Revenue by employee :
SELECT 
    e.FirstName,
    e.LastName,
    SUM(od.UnitPrice * od.Quantity) AS revenue
FROM employees e
JOIN orders o ON e.EmployeeID = o.EmployeeID
JOIN order_details od ON o.OrderID = od.OrderID
GROUP BY e.EmployeeID
ORDER BY revenue DESC;

1Ô∏è‚É£9Ô∏è‚É£ Category performance by country :
SELECT 
    cust.Country,
    c.CategoryName,
    SUM(od.UnitPrice * od.Quantity) AS revenue
FROM customers cust
JOIN orders o ON cust.CustomerID = o.CustomerID
JOIN order_details od ON o.OrderID = od.OrderID
JOIN products p ON od.ProductID = p.ProductID
JOIN categories c ON p.CategoryID = c.CategoryID
GROUP BY cust.Country, c.CategoryName
ORDER BY cust.Country, revenue DESC;

2Ô∏è‚É£0Ô∏è‚É£ Low-performing categories :
SELECT 
    c.CategoryName,
    SUM(od.UnitPrice * od.Quantity) AS revenue
FROM categories c
JOIN products p ON c.CategoryID = p.CategoryID
JOIN order_details od ON p.ProductID = od.ProductID
GROUP BY c.CategoryName
ORDER BY revenue ASC;

